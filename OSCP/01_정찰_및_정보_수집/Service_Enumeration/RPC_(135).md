---
layout: page
title: RPC_(135)
description: >
  This chapter covers the basics of content creation with Hydejack.
hide_description: true
sitemap: false
---

# RPC (135) 가이드

RPC(Remote Procedure Call)는 한 컴퓨터의 프로그램이 네트워크를 통해 다른 컴퓨터의 프로시저(함수)를 실행할 수 있게 해주는 프로토콜입니다. Windows 환경에서는 SMB, WMI, Active Directory 등 수많은 핵심 서비스가 RPC를 기반으로 동작하기 때문에, RPC를 열거하는 것은 내부 시스템의 구조와 정보를 파악하는 데 매우 중요합니다.

https://infinitelogins.com/2020/06/17/enumerating-smb-for-pentesting/
https://www.hackingarticles.in/active-directory-enumeration-rpcclient/

---

### **1. `enum4linux-ng`를 이용한 종합 열거**

- **목표:** RPC와 SMB를 통해 익명(Null Session)으로 접속하여 사용자, 그룹, OS 정보, 암호 정책 등 시스템의 거의 모든 정보를 종합적으로 수집합니다.
- **핵심:** 이 도구 하나만으로도 RPC를 통해 얻을 수 있는 대부분의 정보를 확인할 수 있어 가장 먼저 사용해봐야 할 필수 도구입니다.

```bash(title="enum4linux-ng - 모든 정보 열거")
# -A: 모든 열거 옵션을 활성화하여 타겟 시스템의 정보를 최대한 수집
enum4linux-ng -A $target | tee enum4linux.txt

enum4linux $target | tee enum4linux.log
```

---

### **2. `rpcclient`를 이용한 수동 열거**

- **목표:** `enum4linux-ng`가 너무 많은 정보를 출력하거나 특정 정보만 확인하고 싶을 때, `rpcclient`를 사용하여 대화형으로 RPC 서비스를 직접 탐색합니다.

#### **단계별 절차:**

1.  **접속 :**
    ```bash title="rpcclient - 익명 접속"
    # -U "": 사용자 이름을 빈 값으로 지정
    # -N: 비밀번호를 묻지 않음
    rpcclient -N $target
    
    rpcclient -U "" -N $target
    ```

```bash title="rpcclient - normal login"
rpcclient -U 'twilliams' $target
```

2.  **명령어 확인 및 실행:**
    - 접속에 성공하면 `rpcclient $>` 프롬프트가 나타납니다. `help`를 입력하여 사용 가능한 명령어를 확인합니다.

3.  **주요 명령어 예시:**
    ```bash(title="rpcclient 주요 명령어")
    # 도메인 사용자 목록 열거
    rpcclient $> enumdomusers

    # 도메인 그룹 목록 열거
    rpcclient $> enumdomgroups

    # 시스템 정보 확인
    rpcclient $> srvinfo

    # 패스워드 정책 등 도메인 정보 확인
    rpcclient $> querydominfo
    ```

---

### **3. `impacket-rpcdump` 활용**

- **목표:** 대상 시스템의 RPC 엔드포인트 매퍼(Endpoint Mapper)에 등록된 모든 RPC 서비스의 인터페이스와 UUID를 확인합니다.
- **활용:** 어떤 서비스들이 RPC를 통해 노출되어 있는지 전체적인 그림을 파악하는 데 유용합니다.

```bash(title="rpcdump.py - RPC 엔드포인트 덤프")
impacket-rpcdump @$target
```

